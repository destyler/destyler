<!-- Generated by SpecStory, Markdown v2.0.0 -->

<!-- vscode Session 1c6435eb-c423-48b3-a083-bcd7512b6097 (2025-11-19 13:38Z) -->

# 编写和注册Dialog组件的示例 (2025-11-19 13:38Z)

_**User (2025-11-19 13:55Z)**_

我想你根据 #packages/components/combobox 和 #packages/components/color-picker 的 lit 和 vanilla 的 example 来帮我编写一下 #packages/components/dialog 的 examples 中的 lit 和 vanilla 的例子.你可以看看 #packages/components/dialog 中的 [react](packages/components/dialog/examples/react/Dialog.react.tsx) 和 [solid](packages/components/dialog/examples/solid/Dialog.solid.tsx), [vue](packages/components/dialog/examples/vue/Dialog.vue), [svelte](packages/components/dialog/examples/svelte/Dialog.svelte) ,同时别忘了在 storybook 中注册哦

---

_**Agent (model copilot/gpt-5.1-codex)**_

**Preparing multi-step todo list****Starting task assessment****Reviewing dialog example files****Seeking clear example****Considering alternative frameworks****Requesting Vue example****Confirming style.css presence****Exploring combobox/color-picker examples****Reading literature example****Checking if Combobox.ts is a Lit component****Opening example combobox file****Searching for color-picker examples****Checking for lit file****Searching for vanilla colorpicker example****Checking dialog example patterns****Preparing example folder structure****Checking color picker component****Checking for vanilla Combobox.astro****Considering vanilla color picker approach****Inspecting dialog component and styles****Examining component naming conventions****Identifying needed fields****Exploring dialog component integration with Lit**

I’m piecing together how to build a dialog Lit component using `@destyler/lit` and other packages, referencing typical props and hooking into the dialog machine. I’m examining existing patterns like color-picker and looking into portal usage and shared custom elements like `destyler-layout` to ensure consistent behavior with backdrops and overlays. Let’s explore the portal support and component APIs next!**Investigating portal usage****Searching for portal examples in lit****Checking calendar example usage****Drafting dialog component using portal and controls**

I'm putting together a Lit `Dialog` element using the `portal` function to render the dialog's overlay and backdrop into `document.body`. I’m importing `ControlsController` to connect dialog controls, using inline styles with `unsafeCSS`, and following patterns from existing Lit and vanilla components for subscriptions and render structure. I’ll verify proper prop spreading and manage the backdrop and content portal correctly while ensuring usage aligns with the existing component conventions. I also plan to mark the second todo as done after reviewing relevant examples.**Planning lit example implementation****Planning component integration and setup****Creating Lit example files with portal****Verifying ControlsController usage****Analyzing document usage in SSR context**

I'm examining how `document` is accessed in the module, especially considering server-side rendering with Astro and Vite. Since `document` is undefined on the server, I want to confirm whether it's safe to reference `document.body` inside portal calls without causing errors during SSR, and I’m exploring typical lit component patterns to handle this safely.**Verifying component and type integrations****Preparing vanilla dialog example implementation****Reading type definitions****Examining type exports in dialog package****Investigating missing State type export****Investigating component patterns****Searching for vanilla examples****Selecting vanilla example with Component****Inspecting vanilla usage in calendar examples****Examining calendar example folder****Reviewing Calendar.ts file****Designing vanilla dialog component****Designing dialog component class**

I'm carefully planning a dialog component class that manages DOM elements, overlays, and state listeners. I’m ensuring the overlay attaches and detaches properly with correct stacking, text content is set once, and properties are spread correctly during rendering. I'll also hook up controls and state visualizer integrations, confirm `document` usage is safe for client-side contexts, and prepare for exporting and CSS imports to integrate smoothly with the rest of the app.**Adjusting import order for linting**
```

```
**Creating .astro file for vanilla****Checking for duplicate render IDs****Searching storybook for dialog examples****Inspecting Storybook directory****Inspecting storybook folder****Checking storybook .astro directory****Searching for storybook components****Investigating Storybook setup****Searching for example registration****Inspecting Storybook dialog folder****Planning to add lit and vanilla story examples****Inspecting lit.stories.ts structure****Duplicating for dialog lit and checking story file****Adding new storybook files for dialog components****Creating vanilla story file****Confirming storybook build setup****Considering verification and testing options****Preparing targeted ESLint run****Updating task status****Considering task completion timing****Summarizing final response plan**

I've composed a final message that starts with an acknowledgement and a concise high-level plan summarizing the implemented Lit and Vanilla dialog demos and their Storybook integration. Then, I include detailed bullet points referencing key files, testing steps, and next steps for previewing the new stories.Thanks! I approached this by (1) building the Lit dialog example, (2) building the Vanilla dialog example, and (3) registering both in Storybook with lint verification.

**Details**
- `Dialog.ts` introduces the `destyler-dialog` Lit element using `MachineController`, `portal`, and the shared controls/state visualizer so the markup matches the React/Solid/Svelte implementations; `../examples/lit/Dialog.astro` simply registers the custom element for docs/Storybook consumption.
- `Dialog.ts` adds a vanilla `Component` wrapper that wires triggers/backdrop/content via `spreadProps`, portals the overlay nodes to `document.body`, and keeps the controls + visualizer in sync; `../examples/vanilla/Dialog.astro` mounts it the same way as other vanilla demos.
- Storybook picks up the new demos through `lit.stories.ts` and `vanilla.stories.ts`, each pointing at the corresponding `.astro` example.
- Tests: `pnpm exec eslint `Dialog.ts` `Dialog.ts` `lit.stories.ts` packages/components/dialog/storybook/vanilla.stories.ts`

**Next Steps**
- Preview the new stories locally if you’d like to see them in action:
```bash
pnpm storybook:dev
```

---

