<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- vscode Session ce09770e-2b42-42cb-9863-9a6b62f4ca14 (2025-11-26 05:54Z) -->

# 修复类型分配错误问题 (2025-11-26 05:54Z)

_**User (2025-11-26 05:55Z)**_

修复 `不能将类型“string | null”分配给类型“string”。
  不能将类型“null”分配给类型“string”。`

---

_**Agent (model copilot/gpt-5.1-codex)**_

<tool-use data-tool-type="write" data-tool-name="copilot_applyPatch">
<details>
<summary>Tool use: **copilot_applyPatch** • 正在使用 "应用修补程序"</summary>

```typescript
import { createMachine } from '@destyler/xstate'
import { createEffect } from 'solid-js'
import { render } from 'solid-js/web'
import { describe, expect, it } from 'vitest'
import { useActor } from '../src/hooks/use-actor'
import { useService } from '../src/hooks/use-service'

const tick = () => new Promise(resolve => setTimeout(resolve, 0))

describe('solid useActor', () => {
  it('mirrors service state and forwards send', async () => {
    const machine = createMachine({
      id: 'solid.actor',
      initial: 'idle',
      context: {},
      states: {
        idle: { on: { GO: 'done' } },
        done: {},
      },
    })

    let lastValue: string | null = null
    let send!: (evt: any) => void

    const dispose = render(() => {
      const service = useService(machine)
      const [state, sendFn] = useActor(service)
      send = sendFn
      createEffect(() => {
        lastValue = state.value
      })
      return null
    }, document.createElement('div'))

    await tick()
    expect(lastValue).toBe('idle')

    send({ type: 'GO' } as any)
    await tick()
    expect(lastValue).toBe('done')

    dispose()
  })
})

```


</details>
</tool-use>

---

**Fixing TypeScript string|null assignment error in test****Preparing final response details**- Allow `lastValue` in `actor.spec.ts` to start as `string | null`, matching `state.value`’s type so the assignment from the actor state no longer triggers the `string | null -> string` error. Assertions still check for the expected string values after the effect runs.

Next step: run the Solid framework test suite (e.g., `pnpm test --filter frameworks-solid`) to confirm everything passes end-to-end.

---

