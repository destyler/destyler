<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- vscode Session 2fac24e3-81d9-47f0-8e5c-b35ff1dc3d19 (2025-12-07 06:03Z) -->

# 配置 bumpp 支持多种预发布类型 (2025-12-07 06:03Z)

_**User (2025-12-07 06:06Z)**_

你可以帮我增加 bump 的配置吗我想支持 next 和 alpha 、beta 还有 rc

https://github.com/antfu-collective/bumpp

---

_**Agent (model copilot/claude-opus-4.5)**_

<tool-use data-tool-type="read" data-tool-name="copilot_readFile">
<details>
<summary>Tool use: **copilot_readFile** • 正在读取 [](file:///Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts)</summary>


读取 [](file:///Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts)

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="copilot_replaceString">
<details>
<summary>Tool use: **copilot_replaceString**</summary>

Additional data:

```json
{
  "vscodeToolId": "copilot_replaceString",
  "isHidden": true
}
```
Result:

```json
{
  "invocationMessage": "正在使用 \"替换文件中的字符串\"",
  "isConfirmed": {
    "type": 1
  },
  "content": "&#96;&#96;&#96;typescript\nimport { defineConfig } from 'bumpp'\n\nexport default defineConfig({\n  preid: 'beta',\n  commit: 'release: v%s',\n  tag: 'v%s',\n  push: true,\n  customVersion: async (currentVersion, semver) =&gt; {\n    const { default: prompts } = await import('prompts')\n\n    const prereleaseTypes = ['alpha', 'beta', 'rc', 'next']\n    const releaseTypes = ['patch', 'minor', 'major']\n\n    const parsed = semver.parse(currentVersion)\n    const currentPrerelease = parsed?.prerelease?.[0] as string | undefined\n\n    const choices = [\n      ...releaseTypes.map(type =&gt; ({\n        title: &#96;${type} (${semver.inc(currentVersion, type)})&#96;,\n        value: semver.inc(currentVersion, type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;pre-${type} (${semver.inc(currentVersion, 'prerelease', type)})&#96;,\n        value: semver.inc(currentVersion, 'prerelease', type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;prepatch-${type} (${semver.inc(currentVersion, 'prepatch', type)})&#96;,\n        value: semver.inc(currentVersion, 'prepatch', type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;preminor-${type} (${semver.inc(currentVersion, 'preminor', type)})&#96;,\n        value: semver.inc(currentVersion, 'preminor', type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;premajor-${type} (${semver.inc(currentVersion, 'premajor', type)})&#96;,\n        value: semver.inc(currentVersion, 'premajor', type),\n      })),\n    ]\n\n    // 如果当前是预发布版本，添加升级到正式版的选项\n    if (currentPrerelease &amp;&amp; prereleaseTypes.includes(currentPrerelease)) {\n      const releaseVersion = &#96;${parsed!.major}.${parsed!.minor}.${parsed!.patch}&#96;\n      choices.unshift({\n        title: &#96;release (${releaseVersion})&#96;,\n        value: releaseVersion,\n      })\n    }\n\n    const { version } = await prompts({\n      type: 'select',\n      name: 'version',\n      message: 'Select release type',\n      choices: choices.filter(c =&gt; c.value !== null),\n    })\n\n    return version\n  },\n})\n&#96;&#96;&#96;\n\n",
  "textEditContent": "import { defineConfig } from 'bumpp'\n\nexport default defineConfig({\n  preid: 'beta',\n  commit: 'release: v%s',\n  tag: 'v%s',\n  push: true,\n  customVersion: async (currentVersion, semver) =&gt; {\n    const { default: prompts } = await import('prompts')\n\n    const prereleaseTypes = ['alpha', 'beta', 'rc', 'next']\n    const releaseTypes = ['patch', 'minor', 'major']\n\n    const parsed = semver.parse(currentVersion)\n    const currentPrerelease = parsed?.prerelease?.[0] as string | undefined\n\n    const choices = [\n      ...releaseTypes.map(type =&gt; ({\n        title: &#96;${type} (${semver.inc(currentVersion, type)})&#96;,\n        value: semver.inc(currentVersion, type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;pre-${type} (${semver.inc(currentVersion, 'prerelease', type)})&#96;,\n        value: semver.inc(currentVersion, 'prerelease', type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;prepatch-${type} (${semver.inc(currentVersion, 'prepatch', type)})&#96;,\n        value: semver.inc(currentVersion, 'prepatch', type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;preminor-${type} (${semver.inc(currentVersion, 'preminor', type)})&#96;,\n        value: semver.inc(currentVersion, 'preminor', type),\n      })),\n      { title: '─────────────────', value: null, disabled: true },\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;premajor-${type} (${semver.inc(currentVersion, 'premajor', type)})&#96;,\n        value: semver.inc(currentVersion, 'premajor', type),\n      })),\n    ]\n\n    // 如果当前是预发布版本，添加升级到正式版的选项\n    if (currentPrerelease &amp;&amp; prereleaseTypes.includes(currentPrerelease)) {\n      const releaseVersion = &#96;${parsed!.major}.${parsed!.minor}.${parsed!.patch}&#96;\n      choices.unshift({\n        title: &#96;release (${releaseVersion})&#96;,\n        value: releaseVersion,\n      })\n    }\n\n    const { version } = await prompts({\n      type: 'select',\n      name: 'version',\n      message: 'Select release type',\n      choices: choices.filter(c =&gt; c.value !== null),\n    })\n\n    return version\n  },\n})",
  "toolCallResult": null
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="copilot_findTextInFiles">
<details>
<summary>Tool use: **copilot_findTextInFiles** • 正在搜索文本 `prompts` (`**/package.json`)</summary>


No results found
</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="copilot_replaceString">
<details>
<summary>Tool use: **copilot_replaceString**</summary>

Additional data:

```json
{
  "vscodeToolId": "copilot_replaceString",
  "isHidden": true
}
```
Result:

```json
{
  "invocationMessage": "正在使用 \"替换文件中的字符串\"",
  "isConfirmed": {
    "type": 1
  },
  "content": "&#96;&#96;&#96;typescript\nimport { defineConfig } from 'bumpp'\n\nexport default defineConfig({\n  preid: 'beta',\n  commit: 'release: v%s',\n  tag: 'v%s',\n  push: true,\n  customVersion: async (currentVersion, semver) =&gt; {\n    const readline = await import('node:readline')\n\n    const prereleaseTypes = ['alpha', 'beta', 'rc', 'next']\n    const releaseTypes = ['patch', 'minor', 'major']\n\n    const parsed = semver.parse(currentVersion)\n    const currentPrerelease = parsed?.prerelease?.[0] as string | undefined\n\n    const choices: { title: string, value: string | null }[] = []\n\n    // 如果当前是预发布版本，添加升级到正式版的选项\n    if (currentPrerelease &amp;&amp; prereleaseTypes.includes(currentPrerelease)) {\n      const releaseVersion = &#96;${parsed!.major}.${parsed!.minor}.${parsed!.patch}&#96;\n      choices.push({\n        title: &#96;release (${releaseVersion})&#96;,\n        value: releaseVersion,\n      })\n    }\n\n    choices.push(\n      ...releaseTypes.map(type =&gt; ({\n        title: &#96;${type} (${semver.inc(currentVersion, type as any)})&#96;,\n        value: semver.inc(currentVersion, type as any),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;prerelease-${type} (${semver.inc(currentVersion, 'prerelease', type)})&#96;,\n        value: semver.inc(currentVersion, 'prerelease', type),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;prepatch-${type} (${semver.inc(currentVersion, 'prepatch', type)})&#96;,\n        value: semver.inc(currentVersion, 'prepatch', type),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;preminor-${type} (${semver.inc(currentVersion, 'preminor', type)})&#96;,\n        value: semver.inc(currentVersion, 'preminor', type),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;premajor-${type} (${semver.inc(currentVersion, 'premajor', type)})&#96;,\n        value: semver.inc(currentVersion, 'premajor', type),\n      })),\n    )\n\n    console.log('\\nSelect release type:')\n    choices.forEach((choice, index) =&gt; {\n      console.log(&#96;  ${index + 1}. ${choice.title}&#96;)\n    })\n\n    const rl = readline.createInterface({\n      input: process.stdin,\n      output: process.stdout,\n    })\n\n    return new Promise&lt;string&gt;((resolve) =&gt; {\n      rl.question('\\nEnter number: ', (answer) =&gt; {\n        rl.close()\n        const index = Number.parseInt(answer, 10) - 1\n        if (index &gt;= 0 &amp;&amp; index &lt; choices.length &amp;&amp; choices[index].value) {\n          resolve(choices[index].value!)\n        }\n        else {\n          console.log('Invalid selection, using default patch release')\n          resolve(semver.inc(currentVersion, 'patch')!)\n        }\n      })\n    })\n  },\n})\n&#96;&#96;&#96;\n\n",
  "textEditContent": "import { defineConfig } from 'bumpp'\n\nexport default defineConfig({\n  preid: 'beta',\n  commit: 'release: v%s',\n  tag: 'v%s',\n  push: true,\n  customVersion: async (currentVersion, semver) =&gt; {\n    const readline = await import('node:readline')\n\n    const prereleaseTypes = ['alpha', 'beta', 'rc', 'next']\n    const releaseTypes = ['patch', 'minor', 'major']\n\n    const parsed = semver.parse(currentVersion)\n    const currentPrerelease = parsed?.prerelease?.[0] as string | undefined\n\n    const choices: { title: string, value: string | null }[] = []\n\n    // 如果当前是预发布版本，添加升级到正式版的选项\n    if (currentPrerelease &amp;&amp; prereleaseTypes.includes(currentPrerelease)) {\n      const releaseVersion = &#96;${parsed!.major}.${parsed!.minor}.${parsed!.patch}&#96;\n      choices.push({\n        title: &#96;release (${releaseVersion})&#96;,\n        value: releaseVersion,\n      })\n    }\n\n    choices.push(\n      ...releaseTypes.map(type =&gt; ({\n        title: &#96;${type} (${semver.inc(currentVersion, type as any)})&#96;,\n        value: semver.inc(currentVersion, type as any),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;prerelease-${type} (${semver.inc(currentVersion, 'prerelease', type)})&#96;,\n        value: semver.inc(currentVersion, 'prerelease', type),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;prepatch-${type} (${semver.inc(currentVersion, 'prepatch', type)})&#96;,\n        value: semver.inc(currentVersion, 'prepatch', type),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;preminor-${type} (${semver.inc(currentVersion, 'preminor', type)})&#96;,\n        value: semver.inc(currentVersion, 'preminor', type),\n      })),\n      ...prereleaseTypes.map(type =&gt; ({\n        title: &#96;premajor-${type} (${semver.inc(currentVersion, 'premajor', type)})&#96;,\n        value: semver.inc(currentVersion, 'premajor', type),\n      })),\n    )\n\n    console.log('\\nSelect release type:')\n    choices.forEach((choice, index) =&gt; {\n      console.log(&#96;  ${index + 1}. ${choice.title}&#96;)\n    })\n\n    const rl = readline.createInterface({\n      input: process.stdin,\n      output: process.stdout,\n    })\n\n    return new Promise&lt;string&gt;((resolve) =&gt; {\n      rl.question('\\nEnter number: ', (answer) =&gt; {\n        rl.close()\n        const index = Number.parseInt(answer, 10) - 1\n        if (index &gt;= 0 &amp;&amp; index &lt; choices.length &amp;&amp; choices[index].value) {\n          resolve(choices[index].value!)\n        }\n        else {\n          console.log('Invalid selection, using default patch release')\n          resolve(semver.inc(currentVersion, 'patch')!)\n        }\n      })\n    })\n  },\n})",
  "toolCallResult": null
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="copilot_replaceString">
<details>
<summary>Tool use: **copilot_replaceString**</summary>

Additional data:

```json
{
  "vscodeToolId": "copilot_replaceString",
  "isHidden": true
}
```
Result:

```json
{
  "invocationMessage": "正在使用 \"替换文件中的字符串\"",
  "isConfirmed": {
    "type": 1
  },
  "content": "&#96;&#96;&#96;typescript\nimport process from 'node:process'\nimport { defineConfig } from 'bumpp'\n\nexport default defineConfig({\n  preid: 'beta',\n  commit: 'release: v%s',\n  tag: 'v%s',\n  push: true,\n  customVersion: async (currentVersion, semver) =&gt; {\n    const readline = await import('node:readline')\n&#96;&#96;&#96;\n\n",
  "textEditContent": "import process from 'node:process'\nimport { defineConfig } from 'bumpp'\n\nexport default defineConfig({\n  preid: 'beta',\n  commit: 'release: v%s',\n  tag: 'v%s',\n  push: true,\n  customVersion: async (currentVersion, semver) =&gt; {\n    const readline = await import('node:readline')",
  "toolCallResult": null
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="copilot_getErrors">
<details>
<summary>Tool use: **copilot_getErrors**</summary>


Parameters:

```json
{
  "file_path": "Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts",
  "relativeWorkspacePath": "bump.config.ts"
}
```
Additional data:

```json
{
  "vscodeToolId": "copilot_getErrors",
  "isHidden": false
}
```
Result:

```json
{
  "invocationMessage": "正在检查 [](file:///Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts)",
  "pastTenseMessage": "已检查 [](file:///Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts)，未发现问题",
  "isConfirmed": {
    "type": 1
  },
  "content": "",
  "textEditContent": "",
  "toolCallResult": null
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="copilot_readFile">
<details>
<summary>Tool use: **copilot_readFile** • 正在读取 [](file:///Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts#1-1)，行 1 到 75</summary>


读取 [](file:///Users/elonehoo/Developer/destyler-dev/destyler/bump.config.ts#1-1)，行 1 到 75

</details>
</tool-use>

---

我来帮你配置 bumpp 以支持 `next`、`alpha`、`beta` 和 `rc` 预发布类型。首先让我查看一下现有的 bump 配置文件。 现在我来更新配置文件，添加对 `next`、`alpha`、`beta` 和 `rc` 预发布类型的支持： 需要检查一下项目中是否有 `prompts` 包或者可以使用其他方式。让我检查一下 package.json： 项目中没有 `prompts` 包。让我使用一个更简单的方式，不依赖额外的包： 让我修复 lint 错误： 配置已完成。让我查看最终的文件内容： 配置已完成！`bump.config.ts` 现在支持以下预发布类型：

- **alpha** - 早期测试版本
- **beta** - 测试版本
- **rc** - 发布候选版本
- **next** - 下一版本预览

运行 `bumpp` 时，你将看到一个选择菜单，包含：

1. **正式版本**：`patch`、`minor`、`major`
2. **预发布版本**：
   - `prerelease-{alpha|beta|rc|next}` - 在当前版本基础上递增预发布号
   - `prepatch-{alpha|beta|rc|next}` - patch 预发布
   - `preminor-{alpha|beta|rc|next}` - minor 预发布  
   - `premajor-{alpha|beta|rc|next}` - major 预发布

如果当前版本已经是预发布版本（如 `1.0.0-beta.1`），还会自动添加一个 `release` 选项来直接发布为正式版 `1.0.0`。

---

_**User (2025-12-07 06:07Z)**_

我想要保留之前的做法,现在这样我不知道怎么发版本

---

_**Agent (model copilot/claude-opus-4.5)**_

明白，我来恢复到更简单的配置方式，使用 bumpp 的原生 `release` 参数来支持预发布类型： 

---

